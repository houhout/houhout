<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>计算属性和侦听器</title>
    <script src="../vueJs/vue.js"></script>
    <script src="../../js/h5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.13.1/lodash.min.js"></script>
</head>

<body>

    <div id="example">
        <navBar-backBtn></navBar-backBtn>
        <h2>computed:计算属性</h2>

        <p>Original message: "{{ message }}"</p>
        <p>Computed reversed message: "{{ reversedMessage }}"</p>
        <br>
        <p>Computed reversed message: "{{ message.split('').reverse().join('') }}"</p>
        <br>
        <p>当前时间: "{{ curentTiem }}"</p>
        <br>
        <button @click="mpafunction">调用mpaas插件</button>
        <br>
        <br>
        <button @click="otherm">调用其他方法</button>

        <br>
        <br>
        <p>{{fullName}}</p>
        <br>
        <br>
        <select name="testSeletName" id="testSeletId" @change="selectChage" v-model:value="seltValue">
            <option value="selet1" selected>选择1</option>
            <option value="selet2">选择2</option>
            <option value="selet3">选择3</option>
        </select>
        <br>
        <br>
        <button @click="showSelectChage">打印选中的选项</button>



    </div>

    <h2>侦听器</h2>
    <div id="watch-example">
        <p>
            Ask a yes/no question:
            <input v-model="question">
        </p>
        <p>{{answer}}</p>
    </div>

    <script>

        // 计算属性
        var vm = new Vue({
            el: '#example',
            data: {
                message: 'Hello',
                firstName: 'hao',
                lastName: 'shihou',
                seltValue: 'selet1'
            },
            computed: {
                reversedMessage: function () {
                    return this.message.split('').reverse().join('')
                },
                curentTiem: function () {
                    return new Date(parseInt(Date.now()) * 1000).toLocaleString().replace(/:\d{1,2}$/, ' ');
                },
                fullName: {
                    get() {
                        return '全名是:' + this.firstName + this.lastName
                    },
                    set(newValue) {
                        var names = newValue.split(' ')//split 以 xxx 把字符串分割成数组
                        this.firstName = names[0]
                        this.lastName = names[names.length - 1]
                    }
                },

            },
            methods: {
                mpafunction() {
                    mpClink('Dialog', { 'title': "提示", 'message': 'vue调用mpaas插件', 'buttons': ['确定'] });
                },
                otherm() {
                    this.showlog('调用其他方法')
                },
                showlog: function (str) {
                    console.log(str)
                },
                selectChage: function () {
                    this.showlog(this.seltValue)
                },
                showSelectChage: function () {
                    window.alert(this.seltValue)
                }
            }
        })

        // 侦听器
        var vm2 = new Vue({
            el: '#watch-example',
            data: {
                question: '',
                answer: 'I cannot give you an answer until you ask a question!'
            },
            watch: {

                question(newQ, oldQ) {
                    this.answer = 'Waiting for you to stop typing...'
                    this.debouncedGetAnswer()
                }
            },
            created: function () {
                this.debouncedGetAnswer = _.debounce(this.getAnswer, 500)
            },
            methods: {
                getAnswer: function () {
                    if (this.question.indexOf('?') === -1) {
                        this.answer = 'Questions usually contain a question mark. ;-)'
                        return
                    }
                    this.answer = 'Thinking...'
                    var vm = this
                    axios.get('https://yesno.wtf/api')
                        .then(function (response) {
                            vm.answer = _.capitalize(response.data.answer)
                        })
                        .catch(function (error) {
                            vm.answer = 'Error! Could not reach the API. ' + error
                        })
                }
            }
        })

    </script>
</body>

</html>